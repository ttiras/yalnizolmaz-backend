# Cursor Rules for Nhost backend (Hasura)

## Scope
- Applies to the `nhost/` workspace.

## Core policy
- Do NOT hand-edit Hasura metadata YAML or write manual SQL migrations for tables, permissions, or relationships.
- All changes to tables/permissions/relationships must be performed via one of:
  - Hasura Console/UI (Data/Permissions tabs), or
  - SQL run in Hasura Console “Run SQL”, or
  - Hasura Metadata API (e.g., curl) when not expressible in plain SQL.
- Migration/metadata files are generated automatically by Hasura from those actions. We rely on this so local Hasura state matches tests.
- Never commit or push changes unless the user explicitly requests it.

## When the user asks for changes
- If the request can be done in SQL (create table/columns/indexes, PostgreSQL RLS policies, triggers):
  - Provide ONLY the SQL statements to run in Hasura Console “Run SQL”.
- If it cannot be done in pure SQL (e.g., Hasura permission rules, relationships, root field customizations):
  - Provide the correct Hasura Metadata API commands (e.g., terminal curl) or concise UI steps.
  - Prefer safe, idempotent metadata API examples.

## Allowed edits in repo
- Tests under `nhost/tests/`.
- Helper scripts under `nhost/scripts/`.
- Documentation and non-metadata config (e.g., this `.cursorrules`, `nhost/nhost.toml`).

## Disallowed edits (unless explicitly mirroring auto-generated output)
- Manual edits under `nhost/nhost/metadata/**` or `nhost/nhost/migrations/**` that create/modify tables, permissions, or relationships.

## Rationale
- Ensures changes are applied to the live local Hasura instance first so that auto-generated migrations/metadata stay in sync and tests run against the real state.


